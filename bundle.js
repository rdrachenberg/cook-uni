!function(e){var t={};function o(s){if(t[s])return t[s].exports;var a=t[s]={i:s,l:!1,exports:{}};return e[s].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=t,o.d=function(e,t,s){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(s,a,function(t){return e[t]}.bind(null,a));return s},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var o=0;o<t.length;o++){var s=t[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function a(e,t,o){return t&&s(e.prototype,t),o&&s(e,o),e}function r(e){return!!new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(e)}Sammy("#rooter",(function(){this.use("Handlebars","hbs");var e=null!=window.sessionStorage.getItem("user"),t=window.sessionStorage.getItem("user"),s=(window.sessionStorage.getItem("name"),window.sessionStorage.getItem("name")),n=(window.sessionStorage.getItem("recipe"),window.sessionStorage.getItem("recipe")),i=(window.sessionStorage.getItem("id"),window.sessionStorage.getItem("id"));document.cookie="promo_shown=1; Max-Age=2600000; SameSite=None; Secure";var d=function(){function r(){o(this,r)}return a(r,[{key:"handleHomeRoute",value:function(o){o.loggedIn=e,o.user=t,console.log(t),o.name=s,console.log(s),o.load("/views/header.hbs").then((function(e){o.load("/views/footer.hbs").then((function(t){o.partials={header:e,footer:t},o.partial("./views/index.hbs")}))}))}},{key:"handleRegisterRoute",value:function(o){o.loggedIn=e,o.user=t,o.load("/views/header.hbs").then(setInterval((function(){$("#registrationImage").fadeIn(3500)}),1e3)).then((function(e){o.load("/views/footer.hbs").then((function(t){o.partials={header:e,footer:t},o.partial("/views/register.hbs")}))}))}},{key:"handleLoginRoute",value:function(t){t.loggedIn=e,t.load("/views/header.hbs").then((function(e){t.load("/views/footer.hbs").then((function(o){t.partials={header:e,footer:o},$("#loadingImage").hide(),t.partial("/views/login.hbs")}))}))}},{key:"handleDetailsRoute",value:function(o){o.loggedIn=e,o.user=t,o.recipe=n;var s=o.params.id;console.log(s),console.log(window.sessionStorage);var a="https://baas.kinvey.com/appdata/kid_B1fSQN7fw/recipes/"+s,r=window.sessionStorage.loggedIn;fetch(a,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Kinvey "+r}}).then((function(e){e.ok&&e.json().then((function(e){console.log(e),o.recipe=e}))})).then((function(){o.load("/views/header.hbs").then((function(e){o.load("/views/footer.hbs").then((function(t){o.partials={header:e,footer:t},o.partial("/views/details.hbs")}))}))}))}},{key:"handleEditRoute",value:function(o){var s=function(){$("#loadingBox").toggle(),$("#loadingImage").toggle()};o.loggedIn=e,o.user=t,o.recipe=n,console.log(n);var a=o.params.id;console.log(a);var r="https://baas.kinvey.com/appdata/kid_B1fSQN7fw/recipes/"+a,i=window.sessionStorage.loggedIn;fetch(r,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Kinvey "+i}},s()).then((function(e){e.ok?(s(),e.json().then((function(e){console.log(e),o.recipe=e}))):this.redirect("#/not-found")})).then((function(){o.load("/views/header.hbs").then((function(e){o.load("/views/footer.hbs").then((function(t){o.partials={header:e,footer:t},o.partial("/views/edit.hbs")}))}))}))}},{key:"handleSharedRecipesRoute",value:function(o){o.loggedIn=e,o.user=t,o.recipe=n,o.id=i;var s=window.sessionStorage.loggedIn;fetch("https://baas.kinvey.com/appdata/kid_B1fSQN7fw/recipes",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Kinvey "+s}}).then((function(t){e=!0,t.json().then((function(e){var t=e;o.hasRecipes=t.length>0,o.recipe=t,window.sessionStorage.setItem("recipe",e),i=window.sessionStorage.setItem("id",e._id),console.log(t)}))})).then((function(){o.load("/views/header.hbs").then((function(e){o.load("/views/footer.hbs").then((function(t){o.partials={header:e,footer:t},o.partial("/views/shared_recipes.hbs")}))}))}))}},{key:"handleShareRecipesRoute",value:function(o){o.loggedIn=e,o.user=t,o.load("/views/header.hbs").then((function(e){o.load("/views/footer.hbs").then((function(t){o.partials={header:e,footer:t},o.partial("/views/share.hbs")}))}))}},{key:"handleNotFoundRecipesRoute",value:function(o){o.loggedIn=e,o.user=t,o.load("/views/header.hbs").then((function(e){o.load("/views/footer.hbs").then((function(t){o.partials={header:e,footer:t},o.partial("/views/not_found.hbs")}))}))}}]),r}(),l=function(){function s(){o(this,s)}return a(s,[{key:"login",value:function(o){var s=o.params,a=function(){$("#loadingBox").toggle(),$("#loadingImage").toggle()},r=s.username,n=s.password,i="https://baas.kinvey.com/user/kid_B1fSQN7fw/login";console.log(i);var d=btoa("".concat(r,":").concat(n));console.log(d);var l={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic "+d},body:JSON.stringify({username:r,password:n})};fetch(i,l,a()).then((function(o){console.log(o),o.ok?(a(),$("#successBox").click((function(){console.log("success clicked"),$("#successBox").addClass("close"),$("#successBox").attr("data-dismiss","alert")})),$("#successBox").fadeTo(5e3,500).slideUp(500,(function(){$("#successBox").slideUp(5e3)})),o.json().then((function(o){console.log(o),window.sessionStorage.setItem("user",o.username),window.sessionStorage.setItem("loggedIn",o._kmd.authtoken),window.sessionStorage.setItem("name","".concat(o.firstName," ").concat(o.lastName)),e=!0,t=o.username;var s="".concat(o.firstName," ").concat(o.lastName);console.log(s),$("#defaultRegisterFormUsername").val(""),$("#defaultRegisterFormPassword").val(""),setInterval((function(){window.location.replace("#/")}),6e3)}))):($("#errorBox").click((function(){console.log("success clicked"),$("#errorBox").addClass("close"),$("#errorBox").attr("data-dismiss","alert")})),$("#errorBox").fadeTo(5e3,500).slideUp(500,(function(){$("#errorBox").slideUp(5e3)})),a(),setInterval((function(){window.location.replace("#/register")}),15e3),console.log(o.status))})),console.log("logged in!")}},{key:"logout",value:function(t){var o=this,s="https://baas.kinvey.com/user/kid_B1fSQN7fw/_logout";console.log(s);var a=window.sessionStorage.loggedIn;console.log(a),fetch(s,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Kinvey "+a}}).then((function(t){console.log(t),t.ok?(window.sessionStorage.clear(),$("#successBox").click((function(){console.log("success clicked"),$("#successBox").addClass("close"),$("#successBox").attr("data-dismiss","alert")})),$("#successBox").fadeTo(5e3,500).slideUp(500,(function(){$("#successBox").slideUp(5e3)})),e=!1,o.redirect("/")):(console.log(t.status),window.sessionStorage.clear(),o.redirect("#/not-found"))})),console.log("logged the shibang out!")}},{key:"addRecipe",value:function(e){var t,o=this,s=e.params,a=s.meal,n=s.ingredients,i=s.prepMethod,d=s.description,l=s.foodImageURL,c=s.category,u=a.length>=4,p=n.length>=2,h=i.length>=10,g=d.length>=10,f=r(l);t=u&&p&&h&&g&&f;var m,b="https://cdn.pixabay.com/photo/2017/10/09/19/29/eat-2834549__340.jpg",v="https://cdn.pixabay.com/photo/2014/12/15/13/40/spaghetti-569067_960_720.jpg",w="https://cdn.pixabay.com/photo/2017/06/02/18/24/fruit-2367029__340.jpg",R="https://image.shutterstock.com/image-photo/assorted-dairy-products-milk-yogurt-260nw-530162824.jpg",y="https://t3.ftcdn.net/jpg/01/18/84/52/240_F_118845283_n9uWnb81tg8cG7Rf9y3McWT1DT1ZKTDx.jpg";switch(c){case"Vegetables and legumes/beans":m=b;break;case"Grain Food":m=v;break;case"Fruits":m=w;break;case"Milk, cheese, eggs and alternatives":m=R;break;case"Lean meats and poultry, fish and alternatives":m=y}var x=window.sessionStorage.loggedIn;n=n.split(", "),console.log(n);var k={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Kinvey "+x},body:JSON.stringify({meal:a,ingredients:n,prepMethod:i,description:d,foodImageURL:l,category:c,categoryImageURL:m,likesCounter:0})},S=function(e){$("#errorBox").click((function(){console.log("fail clicked"),$("#errorBox").addClass("close"),$("#errorBox").attr("data-dismiss","alert")})),$("#errorBox").fadeTo(5e3,500).slideUp(500,(function(){$("#errorBox").slideUp(5e3)}))};if(!t){if(!u)return $("#defaultRecepieShareMeal").css("border","3px solid red"),$("#defaultRecepieShareMeal").attr("placeholder","Must be 4 characters or longer"),S(),!1;if($("#defaultRecepieShareMeal").css("border","3px solid green"),!p)return $("#defaultRecepieShareIngredients").change().css("border","3px solid red"),$("#defaultRecepieShareIngredients").attr("placeholder","Must be 4 characters or longer"),S(),!1;if($("#defaultRecepieShareMeal").css("border","3px solid green"),!h)return $("#defaultRecepieShareMethodOfPreparation").css("border","3px solid red"),$("#defaultRecepieShareMethodOfPreparation").attr("placeholder","Must be 10 characters or longer"),S(),!1;if($("#defaultRecepieShareMeal").css("border","3px solid green"),!g)return $("#defaultRecepieShareDescription").css("border","3px solid red"),$("#defaultRecepieShareDescription").attr("placeholder","Must be 10 characters or longer"),S(),!1;if($("#defaultRecepieShareMeal").css("border","3px solid green"),!f)return $("#defaultRecepieShareFoodImageURL").css("border","3px solid red"),$("#defaultRecepieShareFoodImageURL").attr("placeholder","Must be image link"),S(),!1;throw $("#defaultRecepieShareMeal").css("border","3px solid green"),"error"}fetch("https://baas.kinvey.com/appdata/kid_B1fSQN7fw/recipes",k).then((function(e){$("#successBox").click((function(){console.log("success clicked"),$("#successBox").addClass("close"),$("#successBox").attr("data-dismiss","alert")})),$("#successBox").fadeTo(5e3,500).slideUp(500,(function(){$("#successBox").slideUp(5e3)})),$("#defaultRecepieShareMeal").val(""),$("#defaultRecepieShareIngredients").val(""),$("#defaultRecepieShareMethodOfPreparation").val(""),$("#defaultRecepieShareDescription").val(""),$("#defaultRecepieShareFoodImageURL").val(""),console.log(e),o.redirect("#/shared")})),console.log("Added Recipe")}},{key:"handleAddUser",value:function(t){var o,s=t.params,a=s.firstName,r=s.lastName,n=s.username,i=s.password,d=a.length>=2,l=r.length>=2,c=n.length>=3;if(o=d&l&c&i.length>=6,setInterval((function(){$("#registrationImage").toggle()}),1500),o){var u={firstName:a,lastName:r,username:n,password:i};window.sessionStorage.setItem("user",u),console.log(u),e=!0;var p={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic a2lkX0IxZlNRTjdmdzo3ODY3OTVjNWQxNzM0YTU4YjNiNjA4NzUwYTExMmNjMA=="},body:JSON.stringify({firstName:a,lastName:r,username:n,password:i})};fetch("https://baas.kinvey.com/user/kid_B1fSQN7fw",p).then((function(e){console.log(e)})),this.redirect("#/")}else{if($("#errorBox").toggle(),!d)return $("#defaultRegisterFormFirstName").css("border","3px solid red"),$("#defaultRegisterFormFirstName").attr("placeholder","Must be 2 characters or longer"),!1;if(!l)return $("#defaultRegisterFormLastName").css("border","3px solid red"),$("#defaultRegisterFormLastName").attr("placeholder","Must be 2 characters or longer"),!1;if(!c)return $("#defaultRegisterFormUsername").css("border","3px solid red"),$("#defaultRegisterFormUsername").attr("placeholder","Must be 2 characters or longer"),!1;if(!i)return $("#defaultRegisterFormPassword").css("border","3px solid red"),$("#defaultRegisterFormPassword").attr("placeholder","Must be 2 characters or longer"),!1;if(!i)return $("#defaultRegisterRepeatPassword").css("border","3px solid red"),$("#defaultRegisterRepeatPassword").attr("placeholder","Passwords do not match"),!1}console.log("added user")}},{key:"handleEdit",value:function(e){var t=this,o=e.params,s=o.meal,a=o.ingredients,n=o.prepMethod,i=o.description,d=o.foodImageURL,l=o.category,c=o.id;o.id=this.id,console.log(c);var u,p=s.length>=4,h=a.length>=2,g=n.length>=10,f=i.length>=10;console.log("put hit");var m=r(d);u=p&&h&&g&&f&&m;var b,v="https://cdn.pixabay.com/photo/2017/10/09/19/29/eat-2834549__340.jpg",w="https://cdn.pixabay.com/photo/2014/12/15/13/40/spaghetti-569067_960_720.jpg",R="https://cdn.pixabay.com/photo/2017/06/02/18/24/fruit-2367029__340.jpg",y="https://image.shutterstock.com/image-photo/assorted-dairy-products-milk-yogurt-260nw-530162824.jpg",x="https://t3.ftcdn.net/jpg/01/18/84/52/240_F_118845283_n9uWnb81tg8cG7Rf9y3McWT1DT1ZKTDx.jpg";switch(l){case"Vegetables and legumes/beans":b=v;break;case"Grain Food":b=w;break;case"Fruits":b=R;break;case"Milk, cheese, eggs and alternatives":b=y;break;case"Lean meats and poultry, fish and alternatives":b=x}var k="https://baas.kinvey.com/appdata/kid_B1fSQN7fw/recipes/"+c,S=window.sessionStorage.loggedIn;a=a.split(", ");var I={method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Kinvey "+S},body:JSON.stringify({meal:s,ingredients:a,prepMethod:n,description:i,foodImageURL:d,category:l,categoryImageURL:b})},M=function(e){$("#errorBox").click((function(){console.log("fail clicked"),$("#errorBox").addClass("close"),$("#errorBox").attr("data-dismiss","alert")})),$("#errorBox").fadeTo(5e3,500).slideUp(500,(function(){$("#errorBox").slideUp(5e3)}))};if(!u){if(!p)return $("#defaultRecepieEditMeal").css("border","3px solid red"),$("#defaultRecepieEditMeal").attr("placeholder","Must be 4 characters or longer"),M(),!1;if($("#defaultRecepieEditMeal").css("border","3px solid green"),!h)return $("#defaultRecepieEditIngredients").change().css("border","3px solid red"),$("#defaultRecepieEditIngredients").attr("placeholder","Must be 4 characters or longer"),M(),!1;if($("#defaultRecepieEditMeal").css("border","3px solid green"),!g)return $("#defaultRecepieEditMethodOfPreparation").css("border","3px solid red"),$("#defaultRecepieEditMethodOfPreparation").attr("placeholder","Must be 10 characters or longer"),M(),!1;if($("#defaultRecepieEditMeal").css("border","3px solid green"),!f)return $("#defaultRecepieEditDescription").css("border","3px solid red"),$("#defaultRecepieEditDescription").attr("placeholder","Must be 10 characters or longer"),M(),!1;if($("#defaultRecepieEditMeal").css("border","3px solid green"),!m)return $("#defaultRecepieEditFoodImageURL").css("border","3px solid red"),$("#defaultRecepieEditFoodImageURL").attr("placeholder","Must be image link"),M(),!1;throw $("#defaultRecepieEditMeal").css("border","3px solid green"),"error"}fetch(k,I).then((function(e){$("#successBox").click((function(){console.log("success clicked"),$("#successBox").addClass("close"),$("#successBox").attr("data-dismiss","alert")})),$("#successBox").fadeTo(5e3,500).slideUp(500,(function(){$("#successBox").slideUp(5e3)})),$("#defaultRecepieEditMeal").val(""),$("#defaultRecepieEditIngredients").val(""),$("#defaultRecepieEditMethodOfPreparation").val(""),$("#defaultRecepieEditDescription").val(""),$("#defaultRecepieEditFoodImageURL").val(""),console.log(e),t.redirect("#/details/"+c)})),console.log("Edited Recipe")}},{key:"handleLike",value:function(t){var o=t.params;context.loggedIn=e;var s=o.context.id,a="https://baas.kinvey.com/appdata/kid_B1fSQN7fw/recipes/"+s,r=window.sessionStorage.loggedIn;console.log(s);var n={method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Kinvey "+r},body:JSON.stringify({likesCounter:likesCounter})};likesCounter+=1,fetch(a,n).then((function(e){e.ok&&e.json().then((function(e){console.log(e)})).then((function(){redirect("#/details/"+s)}))}))}}]),s}(),c=new d,u=new l;this.get("/",c.handleHomeRoute),this.get("#/register",c.handleRegisterRoute),this.get("#/login",c.handleLoginRoute),this.post("#/login",u.login),this.get("#/logout",u.logout),this.get("#/user",c.handleRegisterRoute),this.post("#/user",u.handleAddUser),this.get("#/details/:id",c.handleDetailsRoute),this.get("#/edit/:id",c.handleEditRoute),this.put("#/edit/:id",u.handleEdit),this.get("#/shared",c.handleSharedRecipesRoute),this.get("#/share",c.handleShareRecipesRoute),this.post("#/share",u.addRecipe),this.put("#/like/:id",u.handleLike),this.get("#/not-found",c.handleNotFoundRecipesRoute)})).run()}]);