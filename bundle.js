!function(e){var o={};function t(s){if(o[s])return o[s].exports;var a=o[s]={i:s,l:!1,exports:{}};return e[s].call(a.exports,a,a.exports,t),a.l=!0,a.exports}t.m=e,t.c=o,t.d=function(e,o,s){t.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:s})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,o){if(1&o&&(e=t(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(t.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var a in e)t.d(s,a,function(o){return e[o]}.bind(null,a));return s},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},t.p="",t(t.s=0)}([function(e,o){function t(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function s(e,o){for(var t=0;t<o.length;t++){var s=o[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function a(e,o,t){return o&&s(e.prototype,o),t&&s(e,t),e}function r(e){return!!new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(e)}Sammy("#rooter",(function(){this.use("Handlebars","hbs");var e=null!=window.sessionStorage.getItem("user"),o=window.sessionStorage.getItem("user"),s=(window.sessionStorage.getItem("name"),window.sessionStorage.getItem("name")),n=(window.sessionStorage.getItem("recipe"),window.sessionStorage.getItem("recipe")),i=(window.sessionStorage.getItem("id"),window.sessionStorage.getItem("id")),d=(window.sessionStorage.getItem("likesCounter"),window.sessionStorage.getItem("likesCounter")),l=(window.sessionStorage.getItem("creator"),window.sessionStorage.getItem("creator"));document.cookie="promo_shown=1; Max-Age=2600000; SameSite=None; Secure";var c=function(){function r(){t(this,r)}return a(r,[{key:"handleHomeRoute",value:function(t){t.loggedIn=e,t.user=o,console.log(o),t.name=window.sessionStorage.getItem("name"),console.log(s),t.load("/views/header.hbs").then((function(e){t.load("/views/footer.hbs").then((function(o){t.partials={header:e,footer:o},t.partial("./views/index.hbs")}))}))}},{key:"handleRegisterRoute",value:function(t){t.loggedIn=e,t.user=o,t.name=s,t.load("/views/header.hbs").then(setInterval((function(){$("#registrationImage").fadeIn(3500)}),1e3)).then((function(e){t.load("/views/footer.hbs").then((function(o){t.partials={header:e,footer:o},t.partial("/views/register.hbs")}))}))}},{key:"handleLoginRoute",value:function(t){t.loggedIn=e,t.user=o,t.name=window.sessionStorage.getItem("name"),t.load("/views/header.hbs").then((function(e){t.load("/views/footer.hbs").then((function(o){t.partials={header:e,footer:o},t.partial("/views/login.hbs")}))}))}},{key:"handleLogoutRoute",value:function(o){e=!1,o.name=window.sessionStorage.getItem("name"),window.sessionStorage.clear(),o.load("/views/header.hbs").then((function(e){o.load("/views/footer.hbs").then((function(t){o.partials={header:e,footer:t},setTimeout((function(){$("#successBox").toggle()}),500),setTimeout((function(){$("#successBox").toggle()}),5e3),o.partial("/views/logout.hbs")}))}))}},{key:"handleDetailsRoute",value:function(t){t.loggedIn=e,t.user=o,t.recipe=n,t.name=window.sessionStorage.getItem("name");var s=t.params.id;console.log(s),d=t.params.likesCounter,console.log(d);var a="https://baas.kinvey.com/appdata/kid_B1fSQN7fw/recipes/"+s,r=window.sessionStorage.loggedIn;fetch(a,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Kinvey "+r}}).then((function(e){e.ok&&e.json().then((function(e){t.hasRecipes=e;var o=t.hasRecipes;t.creator=window.sessionStorage.getItem("creator"),o._acl.creator==t.creator?t.hasRecipes=!0:t.hasRecipes=!1,console.log(t.hasRecipes),console.log(e),t.recipe=e}))})).then((function(){t.load("/views/header.hbs").then((function(e){t.load("/views/footer.hbs").then((function(o){t.partials={header:e,footer:o},t.partial("/views/details.hbs")}))}))}))}},{key:"handleEditRoute",value:function(t){var s=function(){$("#loadingBox").toggle(),$("#loadingImage").toggle()};t.loggedIn=e,t.user=o,t.recipe=n,console.log(n),t.name=window.sessionStorage.getItem("name");var a=t.params.id;console.log(a);var r="https://baas.kinvey.com/appdata/kid_B1fSQN7fw/recipes/"+a,i=window.sessionStorage.loggedIn;fetch(r,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Kinvey "+i}},s()).then((function(e){e.ok?(s(),e.json().then((function(e){console.log(e),t.recipe=e}))):this.redirect("#/not-found")})).then((function(){t.load("/views/header.hbs").then((function(e){t.load("/views/footer.hbs").then((function(o){t.partials={header:e,footer:o},t.partial("/views/edit.hbs")}))}))}))}},{key:"handleSharedRecipesRoute",value:function(t){t.loggedIn=e,t.user=o,t.name=window.sessionStorage.getItem("name"),t.recipe=n,t.id=i,t.creator=window.sessionStorage.getItem("creator"),t.creator=l,console.log(s);var a=window.sessionStorage.loggedIn;fetch("https://baas.kinvey.com/appdata/kid_B1fSQN7fw/recipes",{method:"GET",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Kinvey "+a}}).then((function(o){e=!0,o.json().then((function(e){var o=e;t.hasRecipes=o.length>0,window.sessionStorage.setItem("recipe",e),i=window.sessionStorage.setItem("id",e._id),t.recipe=o,console.log(o)}))})).then((function(){t.load("/views/header.hbs").then((function(e){t.load("/views/footer.hbs").then((function(o){t.partials={header:e,footer:o},t.partial("/views/shared_recipes.hbs")}))}))}))}},{key:"handleShareRecipesRoute",value:function(t){t.loggedIn=e,t.user=o,t.name=window.sessionStorage.getItem("name"),t.load("/views/header.hbs").then((function(e){t.load("/views/footer.hbs").then((function(o){t.partials={header:e,footer:o},t.partial("/views/share.hbs")}))}))}},{key:"handleNotFoundRecipesRoute",value:function(t){t.loggedIn=e,t.user=o,t.name=window.sessionStorage.getItem("name"),t.load("/views/header.hbs").then((function(e){t.load("/views/footer.hbs").then((function(o){t.partials={header:e,footer:o},t.partial("/views/not_found.hbs")}))}))}}]),r}(),u=function(){function s(){t(this,s)}return a(s,[{key:"login",value:function(t){var s=this,a=t.params,r=function(){$("#loadingBox").toggle(),$("#loadingImage").toggle()},n=a.username,i=a.password,d="https://baas.kinvey.com/user/kid_B1fSQN7fw/login";console.log(d);var l=btoa("".concat(n,":").concat(i));console.log(l);var c={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic "+l},body:JSON.stringify({username:n,password:i})};fetch(d,c,r()).then((function(t){console.log(t),t.ok?(r(),$("#loadingImage").toggle(),$("#successBox").click((function(){console.log("success clicked"),$("#successBox").addClass("close"),$("#successBox").attr("data-dismiss","alert")})),$("#successBox").fadeTo(5e3,500).slideUp(500,(function(){$("#successBox").slideUp(5e3)})),t.json().then((function(t){console.log(t),window.sessionStorage.setItem("user",t.username),window.sessionStorage.setItem("loggedIn",t._kmd.authtoken),window.sessionStorage.setItem("name","".concat(t.firstName," ").concat(t.lastName)),window.sessionStorage.setItem("creator",t._acl.creator),e=!0,o=t.username;var a="".concat(t.firstName," ").concat(t.lastName);console.log(a),$("#defaultRegisterFormUsername").val(""),$("#defaultRegisterFormPassword").val(""),$("#sign-up").remove(),window.sessionStorage.getItem("name"),console.log(a),$("#sign-up").remove(),setTimeout((function(){s.redirect("#/shared")}),2e3)}))):($("#errorBox").click((function(){console.log("success clicked"),$("#errorBox").addClass("close"),$("#errorBox").attr("data-dismiss","alert")})),$("#errorBox").fadeTo(5e3,500).slideUp(500,(function(){$("#errorBox").slideUp(5e3)})),r(),console.log(t.status))})),console.log("logged in!")}},{key:"logout",value:function(o){var t=this,s="https://baas.kinvey.com/user/kid_B1fSQN7fw/_logout";console.log(s);var a=window.sessionStorage.loggedIn;console.log(a),fetch(s,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Kinvey "+a}}).then((function(o){console.log(o),o.ok?(window.sessionStorage.clear(),$("#successBox").click((function(){console.log("success clicked"),$("#successBox").addClass("close"),$("#successBox").attr("data-dismiss","alert")})),$("#successBox").fadeTo(5e3,500).slideUp(500,(function(){$("#successBox").slideUp(5e3)})),e=!1,t.redirect("#/logout")):(console.log(o.status),window.sessionStorage.clear(),t.redirect("#/not-found"))})),console.log("logged the shibang out!")}},{key:"addRecipe",value:function(e){var o,t=this,s=e.params,a=s.meal,n=s.ingredients,i=s.prepMethod,d=s.description,l=s.foodImageURL,c=s.category,u=a.length>=4,g=n.length>=2,p=i.length>=10,h=d.length>=10,f=r(l);o=u&&g&&p&&h&&f;var m,w="https://cdn.pixabay.com/photo/2017/10/09/19/29/eat-2834549__340.jpg",v="https://cdn.pixabay.com/photo/2014/12/15/13/40/spaghetti-569067_960_720.jpg",b="https://cdn.pixabay.com/photo/2017/06/02/18/24/fruit-2367029__340.jpg",R="https://image.shutterstock.com/image-photo/assorted-dairy-products-milk-yogurt-260nw-530162824.jpg",x="https://t3.ftcdn.net/jpg/01/18/84/52/240_F_118845283_n9uWnb81tg8cG7Rf9y3McWT1DT1ZKTDx.jpg";switch(c){case"Vegetables and legumes/beans":m=w;break;case"Grain Food":m=v;break;case"Fruits":m=b;break;case"Milk, cheese, eggs and alternatives":m=R;break;case"Lean meats and poultry, fish and alternatives":m=x}var S=window.sessionStorage.loggedIn;n=n.split(", "),console.log(n);var y={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Kinvey "+S},body:JSON.stringify({meal:a,ingredients:n,prepMethod:i,description:d,foodImageURL:l,category:c,categoryImageURL:m,likesCounter:0})},k=function(e){$("#errorBox").click((function(){console.log("fail clicked"),$("#errorBox").addClass("close"),$("#errorBox").attr("data-dismiss","alert")})),$("#errorBox").fadeTo(5e3,500).slideUp(500,(function(){$("#errorBox").slideUp(5e3)}))};if(!o){if(!u)return $("#defaultRecepieShareMeal").css("border","3px solid red"),$("#defaultRecepieShareMeal").attr("placeholder","Must be 4 characters or longer"),k(),!1;if($("#defaultRecepieShareMeal").css("border","3px solid green"),!g)return $("#defaultRecepieShareIngredients").change().css("border","3px solid red"),$("#defaultRecepieShareIngredients").attr("placeholder","Must be 4 characters or longer"),k(),!1;if($("#defaultRecepieShareMeal").css("border","3px solid green"),!p)return $("#defaultRecepieShareMethodOfPreparation").css("border","3px solid red"),$("#defaultRecepieShareMethodOfPreparation").attr("placeholder","Must be 10 characters or longer"),k(),!1;if($("#defaultRecepieShareMeal").css("border","3px solid green"),!h)return $("#defaultRecepieShareDescription").css("border","3px solid red"),$("#defaultRecepieShareDescription").attr("placeholder","Must be 10 characters or longer"),k(),!1;if($("#defaultRecepieShareMeal").css("border","3px solid green"),!f)return $("#defaultRecepieShareFoodImageURL").css("border","3px solid red"),$("#defaultRecepieShareFoodImageURL").attr("placeholder","Must be image link"),k(),!1;throw $("#defaultRecepieShareMeal").css("border","3px solid green"),"error"}fetch("https://baas.kinvey.com/appdata/kid_B1fSQN7fw/recipes",y).then((function(e){$("#successBox").click((function(){console.log("success clicked"),$("#successBox").addClass("close"),$("#successBox").attr("data-dismiss","alert")})),$("#successBox").fadeTo(5e3,500).slideUp(500,(function(){$("#successBox").slideUp(5e3)})),$("#defaultRecepieShareMeal").val(""),$("#defaultRecepieShareIngredients").val(""),$("#defaultRecepieShareMethodOfPreparation").val(""),$("#defaultRecepieShareDescription").val(""),$("#defaultRecepieShareFoodImageURL").val(""),console.log(e),t.redirect("#/shared")})),console.log("Added Recipe")}},{key:"handleAddUser",value:function(o){var t,s=this,a=o.params,r=a.firstName,n=a.lastName,i=a.username,d=a.password,l=r.length>=2,c=n.length>=2,u=i.length>=3,g=d.length>=6;if(t=l&c&u&g&g,setInterval((function(){$("#registrationImage").toggle()}),1500),t){var p={firstName:r,lastName:n,username:i,password:d};$("#successBox").click((function(){console.log("success clicked"),$("#successBox").addClass("close"),$("#successBox").attr("data-dismiss","alert")})),$("#successBox").fadeTo(5e3,500).slideUp(500,(function(){$("#successBox").slideUp(5e3)})),$("#defaultRegisterFormFirstName").val(""),$("#defaultRegisterFormLastName").val(""),$("#defaultRegisterFormUsername").val(""),$("#defaultRegisterFormPassword").val(""),$("#defaultRegisterRepeatPassword").val(""),window.sessionStorage.setItem("user",p),window.sessionStorage.setItem("name",p.firstName+" "+p.lastName),console.log(p),e=!0;var h={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic a2lkX0IxZlNRTjdmdzo3ODY3OTVjNWQxNzM0YTU4YjNiNjA4NzUwYTExMmNjMA=="},body:JSON.stringify({firstName:r,lastName:n,username:i,password:d})};fetch("https://baas.kinvey.com/user/kid_B1fSQN7fw",h).then((function(e){console.log(e),e.ok&&s.redirect("#/shared")}))}else{if($("#errorBox").toggle(),!l)return $("#defaultRegisterFormFirstName").css("border","3px solid red"),$("#defaultRegisterFormFirstName").attr("placeholder","Must be 2 characters or longer"),!1;if(!c)return $("#defaultRegisterFormLastName").css("border","3px solid red"),$("#defaultRegisterFormLastName").attr("placeholder","Must be 2 characters or longer"),!1;if(!u)return $("#defaultRegisterFormUsername").css("border","3px solid red"),$("#defaultRegisterFormUsername").attr("placeholder","Must be 2 characters or longer"),!1;if(!d)return $("#defaultRegisterFormPassword").css("border","3px solid red"),$("#defaultRegisterFormPassword").attr("placeholder","Must be 2 characters or longer"),!1;if(!d)return $("#defaultRegisterRepeatPassword").css("border","3px solid red"),$("#defaultRegisterRepeatPassword").attr("placeholder","Passwords do not match"),!1}console.log("added user")}},{key:"handleEdit",value:function(e){var o=this,t=e.params,s=t.meal,a=t.ingredients,n=t.prepMethod,i=t.description,d=t.foodImageURL,l=t.category,c=t.id;t.id=this.id,console.log(c);var u,g=s.length>=4,p=a.length>=2,h=n.length>=10,f=i.length>=10;console.log("put hit");var m=r(d);u=g&&p&&h&&f&&m;var w,v="https://cdn.pixabay.com/photo/2017/10/09/19/29/eat-2834549__340.jpg",b="https://cdn.pixabay.com/photo/2014/12/15/13/40/spaghetti-569067_960_720.jpg",R="https://cdn.pixabay.com/photo/2017/06/02/18/24/fruit-2367029__340.jpg",x="https://image.shutterstock.com/image-photo/assorted-dairy-products-milk-yogurt-260nw-530162824.jpg",S="https://t3.ftcdn.net/jpg/01/18/84/52/240_F_118845283_n9uWnb81tg8cG7Rf9y3McWT1DT1ZKTDx.jpg";switch(l){case"Vegetables and legumes/beans":w=v;break;case"Grain Food":w=b;break;case"Fruits":w=R;break;case"Milk, cheese, eggs and alternatives":w=x;break;case"Lean meats and poultry, fish and alternatives":w=S}var y="https://baas.kinvey.com/appdata/kid_B1fSQN7fw/recipes/"+c,k=window.sessionStorage.loggedIn;a=a.split(", ");var I={method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Kinvey "+k},body:JSON.stringify({meal:s,ingredients:a,prepMethod:n,description:i,foodImageURL:d,category:l,categoryImageURL:w})},B=function(e){$("#errorBox").click((function(){console.log("fail clicked"),$("#errorBox").addClass("close"),$("#errorBox").attr("data-dismiss","alert")})),$("#errorBox").fadeTo(5e3,500).slideUp(500,(function(){$("#errorBox").slideUp(5e3)}))};if(!u){if(!g)return $("#defaultRecepieEditMeal").css("border","3px solid red"),$("#defaultRecepieEditMeal").attr("placeholder","Must be 4 characters or longer"),B(),!1;if($("#defaultRecepieEditMeal").css("border","3px solid green"),!p)return $("#defaultRecepieEditIngredients").change().css("border","3px solid red"),$("#defaultRecepieEditIngredients").attr("placeholder","Must be 4 characters or longer"),B(),!1;if($("#defaultRecepieEditMeal").css("border","3px solid green"),!h)return $("#defaultRecepieEditMethodOfPreparation").css("border","3px solid red"),$("#defaultRecepieEditMethodOfPreparation").attr("placeholder","Must be 10 characters or longer"),B(),!1;if($("#defaultRecepieEditMeal").css("border","3px solid green"),!f)return $("#defaultRecepieEditDescription").css("border","3px solid red"),$("#defaultRecepieEditDescription").attr("placeholder","Must be 10 characters or longer"),B(),!1;if($("#defaultRecepieEditMeal").css("border","3px solid green"),!m)return $("#defaultRecepieEditFoodImageURL").css("border","3px solid red"),$("#defaultRecepieEditFoodImageURL").attr("placeholder","Must be image link"),B(),!1;throw $("#defaultRecepieEditMeal").css("border","3px solid green"),"error"}fetch(y,I).then((function(e){$("#successBox").click((function(){console.log("success clicked"),$("#successBox").addClass("close"),$("#successBox").attr("data-dismiss","alert")})),$("#successBox").fadeTo(5e3,500).slideUp(500,(function(){$("#successBox").slideUp(5e3)})),$("#defaultRecepieEditMeal").val(""),$("#defaultRecepieEditIngredients").val(""),$("#defaultRecepieEditMethodOfPreparation").val(""),$("#defaultRecepieEditDescription").val(""),$("#defaultRecepieEditFoodImageURL").val(""),console.log(e),o.redirect("#/details/"+c)})),console.log("Edited Recipe")}},{key:"handleLike",value:function(e){e.params}}]),s}(),g=new c,p=new u;this.get("/",g.handleHomeRoute),this.get("#/register",g.handleRegisterRoute),this.get("#/login",g.handleLoginRoute),this.post("#/login",p.login),this.get("#/logout",g.handleLogoutRoute),this.post("#/logout",p.logout),this.get("#/user",g.handleRegisterRoute),this.post("#/user",p.handleAddUser),this.get("#/details/:id",g.handleDetailsRoute),this.get("#/edit/:id",g.handleEditRoute),this.put("#/edit/:id",p.handleEdit),this.get("#/shared",g.handleSharedRecipesRoute),this.get("#/share",g.handleShareRecipesRoute),this.post("#/share",p.addRecipe),this.put("#/like/:id",p.handleLike),this.get("#/not-found",g.handleNotFoundRecipesRoute)})).run()}]);